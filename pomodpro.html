<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">

    <title>MyPomodoro - å°ˆæ³¨å·¥ä½œã€é«˜æ•ˆä¼‘æ¯çš„ç·šä¸Šç•ªèŒ„é˜</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="MyPomodoro æ˜¯ä¸€æ¬¾ç°¡æ½”é«˜æ•ˆçš„ç·šä¸Šç•ªèŒ„é˜è¨ˆæ™‚å™¨ï¼Œå¹«åŠ©ä½ é€éç•ªèŒ„å·¥ä½œæ³•æå‡å°ˆæ³¨åŠ›èˆ‡ç”Ÿç”¢åŠ›ã€‚è‡ªè¨‚å·¥ä½œå’Œä¼‘æ¯æ™‚é–“ï¼Œä¿æŒé«˜æ•ˆå¾ªç’°ï¼">

    <meta property="og:title" content="MyPomodoro - å°ˆæ³¨å·¥ä½œã€é«˜æ•ˆä¼‘æ¯çš„ç·šä¸Šç•ªèŒ„é˜">
    <meta property="og:description" content="ç”¨ MyPomodoro ç•ªèŒ„é˜ï¼Œè¼•é¬†å¯¦è¸ç•ªèŒ„å·¥ä½œæ³•ï¼Œæå‡ä½ çš„å·¥ä½œèˆ‡å­¸ç¿’æ•ˆç‡ï¼">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://inhening31-create.github.io/inhening/pomodpro.html">
    <meta property="og:image" content="https://raw.githubusercontent.com/inhening31-create/inhening/master/pomodoro-thumbnail.png">

    <link rel="icon" type="image/png" href="https://img.icons8.com/color/48/tomato.png">

    <style>
        /* å…¨åŸŸæ¨£å¼ (å¤§è‡´ä¿ç•™åŸæ¨£ï¼Œçµæ§‹å¾ˆå¥½) */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: #fdf6e3;
            color: #333;
            padding: 40px 20px;
            transition: background 0.5s ease;
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        #timer {
            font-size: 48px;
            margin: 20px 0;
        }
        #progressBarContainer {
            width: 90%;
            max-width: 400px;
            height: 10px;
            background: #eee;
            border-radius: 10px;
            margin: 20px auto;
            overflow: hidden;
        }
        #progressBar {
            height: 100%;
            width: 100%;
            background: #ccc; /* èª¿æ•´ 1: åˆå§‹é¡è‰²æ”¹ç‚ºä¸­æ€§ç°è‰² */
            transition: width 1s linear, background 0.5s ease; /* ç•¶å¯¬åº¦æ”¹è®Šæ™‚ï¼Œæœƒç”¨ 1 ç§’ç·šæ€§å‹•ç•«æ•ˆæœï¼Œç•¶èƒŒæ™¯é¡è‰²æ”¹è®Šæ™‚ï¼Œæœƒç”¨ 0.5 ç§’æ¼¸è®Šæ•ˆæœ */
            float: right;
        }
        button, input {
            font-size: 18px;
            padding: 10px 20px;/* è¨­å®šå…§è·ï¼šä¸Šä¸‹ 10pxï¼Œå·¦å³ 20px */
            margin: 5px;/* è¨­å®šå¤–è·ï¼šå››å‘¨å„ 5px */
            border: none;/* ç§»é™¤é è¨­é‚Šæ¡† */
            border-radius: 15px;/* è¨­å®šåœ“è§’é‚Šæ¡† */
        }
        button {
            background: #ff6b6b;/* è¨­å®šæŒ‰éˆ•èƒŒæ™¯é¡è‰² */
            color: white;/* è¨­å®šæ–‡å­—é¡è‰² */
            cursor: pointer;/* ç•¶æ»‘é¼ ç§»åˆ°æŒ‰éˆ•ä¸Šæ™‚ï¼ŒæŒ‡æ¨™æœƒè®Šæˆå°æ‰‹ */
        }
        button:hover {/*ç•¶æ»‘é¼ ç§»åˆ° <button> ä¸Šæ™‚ï¼Œå¥—ç”¨æŒ‡å®šçš„æ¨£å¼*/
            background: #ff4b4b;
        }
        input {
            width: 80px;
            text-align: center;
            border: 1px solid #ccc;
        }
        /* é‚è¼¯èª¿æ•´ 1: æ–°å¢ç¦ç”¨è¼¸å…¥æ¡†çš„æ¨£å¼ */
        /* ç•¶è¨ˆæ™‚å™¨åœ¨è·‘çš„æ™‚å€™ï¼Œæˆ‘å€‘æœƒç¦ç”¨æ™‚é–“è¨­å®šï¼Œé¿å…ä½¿ç”¨è€…èª¤æ”¹ã€‚
           é€™å€‹æ¨£å¼è®“ä½¿ç”¨è€…ä¸€çœ‹å°±çŸ¥é“ç¾åœ¨ä¸èƒ½è¼¸å…¥ã€‚*/
        input:disabled {
            background-color: #f0f0f0;
            cursor: not-allowed;
            color: #888;
        }
        #customAlert {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        #customAlertContent {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            width: 80%;
            max-width: 300px;
        }
        .green-btn {/*æ‰€æœ‰ class="green-btn" çš„å…ƒç´ ï¼Œéƒ½æœƒå¥—ç”¨é€™å€‹æ¨£å¼*/
            background: #4caf50 !important;
        }
        .green-btn:hover {
            background: #45a049 !important;
        }
        @media (max-width: 600px) {
            body { padding: 20px; }
            h1 { font-size: 1.8rem; }
            #timer { font-size: 36px; }
            button, input { font-size: 16px; padding: 8px 12px; }
            #progressBarContainer { width: 100%; }
        }
    </style>
</head>
<body>
    <h1>ğŸ… MyPomodoro</h1>
    <div>
        <span id="workLabel">ğŸ’ª å·¥ä½œæ™‚é–“ (åˆ†é˜):</span>
        <!-- è¼¸å…¥æ¡†: ä½¿ç”¨è€…å¯ä»¥è¼¸å…¥æ•¸å­—ï¼Œé è¨­æ˜¯ 25ï¼Œæœ€å°å€¼æ˜¯ 1 -->
        <input type="number" id="workInput" value="25" min="1"> <br>
        <span id="breakLabel">ğŸµ ä¼‘æ¯æ™‚é–“ (åˆ†é˜):</span>
        <input type="number" id="breakInput" value="5" min="1"> <br>
    </div>

    <div id="timer">25:00</div>
    <div id="progressBarContainer">
        <div id="progressBar"></div>
    </div>
    
    <button id="startBtn">é–‹å§‹</button>
    <button id="pauseBtn">æš«åœ</button>
    <button id="resetBtn">é‡ç½®/æ›´æ–°</button>

    <div id="customAlert">
        <div id="customAlertContent">
            <p id="alertMessage">æ™‚é–“åˆ°å›‰ï¼</p>
            <button id="closeAlertBtn">ç¢ºèª</button>
        </div>
    </div>

    <script>
    // JS é‚è¼¯å„ªåŒ–ï¼š
    // Hiï¼æ¥ä¸‹ä¾†æ˜¯ JavaScript çš„éƒ¨åˆ†ã€‚
    // åŸæœ¬çš„ç¨‹å¼ç¢¼åœ¨è¨ˆæ™‚å™¨è·‘å®Œã€è·³çª—ã€å†è‡ªå‹•é–‹å§‹ä¸‹å€‹è¨ˆæ™‚å™¨çš„æµç¨‹ä¸­ï¼Œé‚è¼¯æ¯”è¼ƒç¹ã€‚
    // æˆ‘æŠŠç¨‹å¼ç¢¼çš„è·è²¬åŠƒåˆ†å¾—æ›´æ¸…æ¥šï¼Œè®“ç‹€æ…‹ç®¡ç†æ›´ç©©å®šï¼Œä¹Ÿæ›´å®¹æ˜“ç¶­è­·ã€‚

    // --- DOM å…ƒç´ å€ ---
    // é‚è¼¯èª¿æ•´ 2: å°‡æ‰€æœ‰æœƒç”¨åˆ°çš„ HTML å…ƒç´ å…ˆæŠ“å‡ºä¾†å­˜æˆè®Šæ•¸ã€‚
    // å¥½è™•ï¼š1. åŸ·è¡Œæ•ˆç‡ç¨é«˜ (ä¸ç”¨ä¸€ç›´é‡è¤‡æ‰¾)ã€‚ 2. ç¨‹å¼ç¢¼æ›´æ•´æ½”ï¼Œä¸€çœ‹å°±çŸ¥é“æ“ä½œäº†å“ªäº›æ±è¥¿ã€‚
    //åˆ°æ•´å€‹ç¶²é  (document) è£¡ï¼Œæ‰¾åˆ° id="timer" çš„å…ƒç´ ï¼ŒæŠŠå®ƒå­˜åœ¨ timerDisplay é€™å€‹ç›’å­è£¡ï¼Œä¹‹å¾Œè¦æ“ä½œå®ƒå°±ç”¨ timerDisplayã€‚
    const timerDisplay = document.getElementById("timer");
    const progressBar = document.getElementById("progressBar");
    const workInput = document.getElementById("workInput");
    const breakInput = document.getElementById("breakInput");
    const startBtn = document.getElementById("startBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const resetBtn = document.getElementById("resetBtn");
    const customAlert = document.getElementById("customAlert");
    const alertMessage = document.getElementById("alertMessage");
    const closeAlertBtn = document.getElementById("closeAlertBtn");

    // --- ç‹€æ…‹è®Šæ•¸å€ ---
    let workTime, breakTime, timeLeft;
    let timerId = null;
    let isWorkSession = true;
    let isRunning = false;

    // --- æ ¸å¿ƒå‡½å¼å€ ---

    // å‡½å¼ 1: æ›´æ–°æ‰€æœ‰ç•«é¢é¡¯ç¤º (æ™‚é–“ã€é€²åº¦æ¢ã€èƒŒæ™¯ã€æŒ‰éˆ•é¡è‰²ã€ç¶²é æ¨™é¡Œ)
    function updateUI() {
        let minutes = Math.floor(timeLeft / 60);
        let seconds = timeLeft % 60;
        timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        
        // å‹•æ…‹æ›´æ–°ç¶²é æ¨™é¡Œï¼Œè¶…å¯¦ç”¨ï¼
        if (isRunning) {
            document.title = `${timerDisplay.textContent} - ${isWorkSession ? "å·¥ä½œä¸­" : "ä¼‘æ¯ä¸­"} | MyPomodoro`;
        } else {
            document.title = "MyPomodoro - å°ˆæ³¨å·¥ä½œã€é«˜æ•ˆä¼‘æ¯çš„ç·šä¸Šç•ªèŒ„é˜";
        }

        const totalTime = isWorkSession ? workTime : breakTime;
        // é‚è¼¯ä¿®æ­£ 1: é¿å… totalTime ç‚º 0 å°è‡´ç¨‹å¼å‡ºéŒ¯ (division by zero)
        const percent = totalTime > 0 ? (timeLeft / totalTime) * 100 : 100;
        progressBar.style.width = percent + "%";

        if (!isRunning) {
            document.body.style.background = "#fdf6e3";
            progressBar.style.background = "#ccc";
            document.querySelectorAll("button").forEach(btn => btn.classList.remove("green-btn"));
        } else if (isWorkSession) {
            document.body.style.background = "#ffe4c4";
            progressBar.style.background = "#ff6b6b";
            document.querySelectorAll("button").forEach(btn => btn.classList.remove("green-btn"));
        } else {
            document.body.style.background = "#dfffe0";
            progressBar.style.background = "#4caf50";
            document.querySelectorAll("button").forEach(btn => btn.classList.add("green-btn"));
        }
    }

    // å‡½å¼ 2: é–‹å§‹è¨ˆæ™‚
    function startTimer() {
        // é‚è¼¯ä¿®æ­£ 2: å¦‚æœæ­£åœ¨è·‘ï¼Œæˆ–æ˜¯æ™‚é–“å·²ç¶“æ²’äº†ï¼Œå°±ä¸è¦é‡è¤‡å•Ÿå‹•ã€‚
        if (isRunning || timeLeft <= 0) return;

        isRunning = true;
        toggleInputs(false); // é–‹å§‹è¨ˆæ™‚å¾Œï¼Œç¦ç”¨è¼¸å…¥æ¡†
        updateUI();

        timerId = setInterval(() => {
            timeLeft--;
            updateUI();
            if (timeLeft < 0) { // æ”¹ç‚º < 0 ç¢ºä¿ 00:00 æœƒé¡¯ç¤ºä¸€ç§’
                timerEndSequence();
            }
        }, 1000);
    }

    // å‡½å¼ 3: æš«åœè¨ˆæ™‚
    function pauseTimer() {
        clearInterval(timerId);
        timerId = null;
        isRunning = false;
        toggleInputs(true); // æš«åœæ™‚ï¼Œå…è¨±ä½¿ç”¨è€…ä¿®æ”¹æ™‚é–“
        updateUI();
    }

    // å‡½å¼ 4: é‡ç½®èˆ‡æ›´æ–°è¨­å®š (å–ä»£ä½ åŸæœ¬çš„ resetTimer)
    function applySettingsAndReset() {
        pauseTimer(); // å…ˆç¢ºä¿è¨ˆæ™‚å™¨æ˜¯æš«åœçš„
        isWorkSession = true;
        
        // è®€å–ä¸¦æ›´æ–°æ™‚é–“è¨­å®šï¼Œä¸¦åŠ ä¸ŠåŸºæœ¬é©—è­‰ï¼Œé˜²æ­¢è¼¸å…¥è² æ•¸æˆ–é›¶
        workTime = Math.max(1, parseInt(workInput.value)) * 60;
        breakTime = Math.max(1, parseInt(breakInput.value)) * 60;
        workInput.value = workTime / 60; // å°‡æ ¡æ­£å¾Œçš„å€¼å¯«å›è¼¸å…¥æ¡†
        breakInput.value = breakTime / 60;

        timeLeft = workTime;
        updateUI();
    }

    // å‡½å¼ 5: è¨ˆæ™‚çµæŸå¾Œçš„è™•ç†æµç¨‹ (æŠŠç›¸é—œé‚è¼¯é›†ä¸­ç®¡ç†)
    function timerEndSequence() {
        pauseTimer(); // ç”¨ pauseTimer ä¾†åœæ­¢è¨ˆæ™‚å™¨ä¸¦æ›´æ–°ç‹€æ…‹

        const message = isWorkSession ? "åŠªåŠ›å¤ ä¹…å•¦ï¼ç¾åœ¨ä¼‘æ¯ä¸€ä¸‹å§ğŸµï¼" : "ä¼‘æ¯æ™‚é–“çµæŸäº†ï¼è®“æˆ‘å€‘ç¹¼çºŒåŠªåŠ›ğŸ’ªï¼";
        const notificationTitle = isWorkSession ? "ä¼‘æ¯æ™‚é–“åˆ°" : "ä¼‘æ¯çµæŸ";
        
        showAlert(message);
        sendNotification(notificationTitle, message);
        
        setupNextSession(); // æº–å‚™ä¸‹ä¸€å›åˆ
    }

    // å‡½å¼ 6: æº–å‚™ä¸‹ä¸€å€‹å›åˆ (æ–°å‡½å¼ï¼Œåªåˆ‡æ›ç‹€æ…‹ï¼Œä¸è‡ªå‹•é–‹å§‹)
    function setupNextSession() {
        isWorkSession = !isWorkSession;
        timeLeft = isWorkSession ? workTime : breakTime;
        updateUI();
    }

    // --- è¼”åŠ©å‡½å¼ ---
    function toggleInputs(enabled) {
        workInput.disabled = !enabled;
        breakInput.disabled = !enabled;
    }

    function showAlert(message) {
        alertMessage.textContent = message;
        customAlert.style.display = "flex";
    }

    // é‚è¼¯ä¿®æ­£ 3: é—œé–‰æç¤ºçª—æ™‚ï¼Œä¸å†è‡ªå‹•é–‹å§‹ã€‚è®“ä½¿ç”¨è€…è‡ªå·±é»æ“Šã€Œé–‹å§‹ã€ã€‚
    function closeAlert() {
        customAlert.style.display = "none";
    }

    // è·¨åˆ†é é€šçŸ¥ (ä½ çš„ç‰ˆæœ¬å¾ˆæ£’ï¼Œå¹¾ä¹æ²’å‹•)
    function sendNotification(title, message) {
        if (!("Notification" in window)) {
            console.log("é€™å€‹ç€è¦½å™¨ä¸æ”¯æ´æ¡Œé¢é€šçŸ¥");
            return;
        }
        if (Notification.permission === "granted") {
            new Notification(title, { body: message, icon: "https://img.icons8.com/color/48/tomato.png" });
        }
    }

    // --- åˆå§‹åŒ–èˆ‡äº‹ä»¶ç›£è½ ---
    // é‚è¼¯èª¿æ•´ 3: æ”¹ç”¨ addEventListener ç¶å®šäº‹ä»¶ï¼Œå¯¦ç¾ HTML/JS åˆ†é›¢ã€‚
    startBtn.addEventListener('click', startTimer);
    pauseBtn.addEventListener('click', pauseTimer);
    resetBtn.addEventListener('click', applySettingsAndReset);
    closeAlertBtn.addEventListener('click', closeAlert);

    // ç¶²é ä¸€è¼‰å…¥ï¼Œå°±å…ˆè«‹æ±‚é€šçŸ¥æ¬Šé™
    window.addEventListener('load', () => {
        if (Notification.permission !== "granted" && Notification.permission !== "denied") {
            Notification.requestPermission();
        }
        // ç¶²é è¼‰å…¥å¾Œï¼Œç«‹åˆ»åŸ·è¡Œä¸€æ¬¡ï¼Œç¢ºä¿ç•«é¢æ˜¯æ­£ç¢ºçš„åˆå§‹ç‹€æ…‹ã€‚
        applySettingsAndReset();
    });
    </script>
</body>
</html>